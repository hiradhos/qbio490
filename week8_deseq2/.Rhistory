knitr::opts_knit$set(root.dir = normalizePath("../week8_deseq2/analysis_data"))
# install "DESeq2" using BiocManager::install()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
BiocManager::install("DESeq2")
BiocManager::install("SummarizedExperiment")
BiocManager::install("TCGABiolinks")
# load DESEq2, SummarizedExperiment, and TCGABiolinks
library("DESeq2")
# load DESEq2, SummarizedExperiment, and TCGABiolinks
library("DESeq2")
library("SummarizedExperiment")
library("TCGABiolinks")
install.packages("TCGABiolinks")
BiocManager::install("TCGAbiolinks")
library("TCGAbiolinks")
# you can read these in from .csv's or from your .RData file
rna_se <-
rna_counts <- read.csv("../analysis_data/brca_rna_count_data.csv")
knitr::opts_knit$set(root.dir = normalizePath("../week5_more_clinical/analysis_data"))
rna_clinical <- read.csv("../../week7_rna/brca_rna_clincial_data.csv")
knitr::opts_knit$set(root.dir = normalizePath("../week5_more_clinical/analysis_data"))
knitr::opts_knit$set(root.dir = normalizePath("../week8_deseq2/analysis_data"))
# you can read these in from .csv's or from your .RData file
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
knitr::opts_knit$set(root.dir = normalizePath("../week5_more_clinical/analysis_data/"))
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
library(TCGAbiolinks)
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
GDCdownload(rna_query)
rna_se <- GDCprepare(rna_query)
write.csv("../week8_deseq2/analysis_data/rna_se_data.csv")
write.csv(rna_se, "../week8_deseq2/analysis_data/rna_se_data.csv")
# you can read these in from .csv's or from your .RData file
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
# you can read these in from .csv's or from your .RData file
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
rna_se <- GDCquery(rna_query)
install.packages("rmarkdown")
library("rmarkdown")
rna_se <- GDCquery(rna_query)
View(rna_se)
View(rna_se)
# you can read these in from .csv's or from your .RData file
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
# you can read these in from .csv's or from your .RData file
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
rna_se <- GDCquery(rna_query)
knitr::opts_knit$set(root.dir = normalizePath("../week8_deseq2/analysis_data"))
# install "DESeq2" using BiocManager::install()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
BiocManager::install("SummarizedExperiment")
BiocManager::install("TCGAbiolinks")
# load DESEq2, SummarizedExperiment, and TCGABiolinks
library("DESeq2")
# load DESEq2, SummarizedExperiment, and TCGABiolinks
library("DESeq2")
library("SummarizedExperiment")
library("TCGAbiolinks")
# you can read these in from .csv's or from your .RData file
rna_query <- GDCquery(project = "TCGA-BRCA",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts")
rna_se <- GDCquery(rna_query)
devtools::install_github("BioinformaticsFMRP/TCGAbiolinks") #BiocManaager::instal gave version that didn't work with GDCquery
install.packages("devtools", dependencies = TRUE)
install.packages("robustbase")
devtools::install_github("BioinformaticsFMRP/TCGAbiolinks") #BiocManaager::instal gave version that didn't work with GDCquery
library("TCGAbiolinks")
rna_se <- GDCquery(rna_query)
knitr::opts_knit$set(root.dir = normalizePath("../week8_deseq2/analysis_data"))
# install "DESeq2" using BiocManager::install()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
install.packages("BiocManager")
BiocManager::install("DESeq2")
BiocManager::install("SummarizedExperiment")
BiocManager::install("DESeq2")
BiocManager::install("SummarizedExperiment")
install.packages("devtools", dependencies = TRUE)
install.packages("robustbase")
devtools::install_github("BioinformaticsFMRP/TCGAbiolinks") #BiocManaager::instal gave error
# load DESEq2, SummarizedExperiment, and TCGABiolinks
library("DESeq2")
library("SummarizedExperiment")
library("TCGAbiolinks")
# you can read these in from .csv's or from your .RData file
load("../analysis_data/clinical_maf_rna_2.RData")
knitr::opts_knit$set(root.dir = normalizePath("../week8_deseq2/analysis_data"))
# install "DESeq2" using BiocManager::install()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
BiocManager::install("SummarizedExperiment")
install.packages("devtools", dependencies = TRUE)
install.packages("robustbase")
install.packages("devtools", dependencies = TRUE)
devtools::install_github("BioinformaticsFMRP/TCGAbiolinks") #BiocManaager::instal gave error
# load DESEq2, SummarizedExperiment, and TCGABiolinks
library("DESeq2")
library("SummarizedExperiment")
library("TCGAbiolinks")
# you can read these in from .csv's or from your .RData file
load("../analysis_data/clinical_maf_rna_2.RData")
rna_counts <- read.csv("../analysis_data/brca_rna_count_data.csv")
rna_genes <- read.csv("../analysis_data/brca_rna_gene_data.csv")
rna_clinical <- read.csv("../analysis_data/brca_rna_clinical_data.csv")
?factor
# write code here
factor(rna_clinical$age_category)
head(rna_clinical$age_category)
# write code here
factor(rna_clinical$ajcc_pathologic_stage)
factor(rna_clinical$ajcc_pathologic_n)
head(rna_clinical$ajcc_pathologic_stage)
head(rna_clinical$ajcc_pathologic_n)
# write code here
sum(is.na(rna_clinical$age_category))
sum(is.na(rna_clinical$ajcc_pathologic_stage)) #contains NA values!
sum(is.na(rna_clinical$ajcc_pathologic_n))
na_mask <- ifelse(is.na(rna_clinical$ajcc_pathologic_stage) == TRUE, FALSE, TRUE) # you can use multiple NA masks if you have multiple columns with NA values (or you can do it all in one!)
rna_clinical <- rna_clinical[na_mask, ] # think about where the mask goes in the df[rows, columns] notation
rna_counts <- rna_counts[, na_mask] # does the mask go in the same or opposite location?
# use rowSums() to create a list with the total number of counts of each gene
row_sums <- rowSums(rna_counts[,2:1102])
# create a boolean mask where genes with < 10 total counts are FALSE, and genes with >= 10 total counts are TRUE
low_counts_mask <- ifelse(row_sums < 10, FALSE, TRUE)
# rewrite the rna_counts df, subsetting for only genes with >= 10 total counts
rna_counts <- rna_counts[low_counts_mask,]
?DESeqDataSetFromMatrix
dds = DESeqDataSetFromMatrix(countData = rna_counts_matrix,
colData = rna_clinical,
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
dds = DESeqDataSetFromMatrix(countData = rna_counts,
colData = rna_clinical,
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
dds = DESeqDataSetFromMatrix(countData = rna_counts[2:1102],
colData = rna_clinical,
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
dds = DESeqDataSetFromMatrix(countData = as.data.frame(rna_counts[2:1102]),
colData = rna_clinical,
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
rna_clinical
dds = DESeqDataSetFromMatrix(countData = as.data.frame(rna_counts[2:1102]),
colData = rna_clinical[2:1101],
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
dds = DESeqDataSetFromMatrix(countData = as.data.frame(rna_counts[,2:1102]),
colData = rna_clinical[,2:1101],
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
length(rna_counts)
length(rna_clinical)
length(rna_clinical$age_category)
dds = DESeqDataSetFromMatrix(countData = as.data.frame(rna_counts[,2:1101]),
colData = rna_clinical[2:1101,],
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
dds = DESeqDataSetFromMatrix(countData = rna_counts[,2:1101],
colData = rna_clinical[2:1101,],
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
?DESeqDataSetFromMatrix
dds = DESeqDataSetFromMatrix(countData = rna_counts[,2:1101],
colData = rna_clinical[2:1101,],
design = ~rna_clinical$age_category + rna_clinical$ajcc_pathologic_stage + rna_clinical$ajcc_pathologic_n)
rownames(rna_counts) = colnames(rna_clinical)
rownames(rna_counts[2:1102]) = colnames(rna_clinical)
length(rna_counts[2:1102])
length(rna_clinical)
View(rna_clinical)
View(rna_clinical)
nrows(rna_counts[2:1102])
nrows(as.data.frame(rna_counts[2:1102]))
remove(young_maf)
remove(old_maf)
remove(maf_object)
remove(low_counts_mask)
remove(rna_mask)
remove(na_mask)
load("/Users/hiradh/Desktop/qbio_490_hirad_hosseini/week8_deseq2/analysis_data/clinical_maf_rna_2.RData")
remove(maf_object)
remove(old-maf)
remove(old_maf)
remove(young_maf)
